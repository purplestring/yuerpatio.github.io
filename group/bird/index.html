<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta id="meta" name="viewport">
	<script>document.getElementById("meta").content="width=device-width, initial-scale="+window.screen.width/1060+",maximum-scale=1, user-scalable=no"; </script>
    <meta charset="UTF-8">
	<link rel="stylesheet" href="../../main/css/style.css" type="text/css" />
	<style>
		[v-cloak] {display:none;}
	</style>
	<title>é³¥ä¹‹å†Œ</title>
	<link rel="icon" type="image/x-ico" href="../../yuer.ico" />
	<script src="bird.js"></script>
	<script src="../../main/js/comments.js"></script>
	<script src="../../main/js/vue.min.js"></script>
</head>

<body>
	<div id="main" v-cloak>
		<div id="mt"></div><div id="lm"></div><div id="rm"></div>
		<div id="mb"></div><div id="lt"></div><div id="rt"></div>
		<div id="lb"></div><div id="rb"></div><div id="ltx"></div>
		<div id="rtx"></div><div id="lbx"></div><div id="rbx"></div><br><br>
		<div v-if="id==-1">
			<div class="title" @click="test=!test" align="center">é³¥ä¹‹å†Œ</div><br><br>
			<div class="desc1">æ°´ç§¯è€Œé±¼èšï¼Œæœ¨èŒ‚è€Œé¸Ÿé›†ã€‚<br>
				å¤©ä¸Šï¼Œæ°´ä¸Šï¼Œä¸›è½é—´ï¼Œå‡¡æœ‰è§è€…ï¼Œçš†ä»¥å¿—ä¹‹ã€‚</div><br>
			<div class="desc2"><span style="color: darkcyan;">æµ…è“é“¾</span>é™„å›¾ä¸ºç´«æœˆæ‹æ‘„ï¼ŒåµŒæœ‰æ•°å­—æ°´å°ï¼›<br>é¸Ÿç±»æ•°æ®å‚è€ƒã€Šä¸­å›½é¸Ÿç±»é‡å¤–æ‰‹å†Œã€‹ã€‚<br>
				è½¬è½½è¯·æ³¨æ˜æ¥æºï¼Œå…¶ä»–ç”¨é€”è¯·<a href="../h5/set/email/index.html">ç§ä¿¡</a>ã€‚<br><br>
				ã€ç­›é€‰ğŸ”ã€‘ç°ï¼šæ—  | é»‘ï¼šæ˜¯ | ç™½ï¼šé | <span @click.prevent="reSet()" style="cursor:pointer;color:green;">é‡ç½®</span><br>			
				 <span v-for="(item, i) in statename">
					<span v-if="i==0 || statename[i].split('|')[0]!=statename[i-1].split('|')[0]"><br>{{"ã€"+statename[i].split("|")[0]+"ã€‘"}}</span>
					<span v-if="i==32 || i==38"><br></span>
					<a :style="'color:'+statecolor[statevalue[i]]" @click="setType(i)" style="cursor:pointer;">
					{{statename[i].indexOf("|")==-1?statename[i]:statename[i].split("|")[1]}} </a>
				</span>								
			</div><br><br>
			<span v-for="(item, i) in list">	
				<span v-if="list[i].fliter">			
					<div v-if="i<1329 && (getPre(i)<0 || item.ke!=list[getPre(i)].ke)" class="family"><br/><br/>{{item.mu}}->{{item.ke}}<br/><br/></div>
					<div v-if="item.id==2001" class="family"><br/><br/>ç•ªå¤–<br/><br/></div>
					<div v-if="item.id==3001" class="family"><br/><br/>æœªåˆ—<br/><br/></div>	
					<div v-if="item.id==4001" class="family"><br/><br/>å…¶å®ƒ<br/><br/></div>				
					<a v-if="item.pic!=null" @click.prevent="id=i" style="color: darkcyan; cursor: pointer;">{{item.wu}} </a>
					<a v-if="item.pic==null && i<1333" @click.prevent="id=i" style="color: #202096; cursor: pointer;">{{item.wu}} </a>
				</span>					
			</span><br><br>
		</div>
		<div v-if="id>=0">
			<div class='title' @click="test=!test" align='center'>{{list[id].wu}}<br></div><br>
			<div align='center'>
				<a @click.prevent="preFamily()" style="cursor: pointer;">â—€â—€â—€</a>
				<a @click.prevent="prePic()" style="cursor: pointer;">â—€â—€</a>
				<a @click.prevent="id=getPre(id)" style="cursor: pointer;">â—€ã€€</a>
				ã€{{id+1}}ã€‘
				<a @click.prevent="id=getNext(id)" style="cursor: pointer;">ã€€â–¶</a>	
				<a @click.prevent="nextPic()" style="cursor: pointer;">â–¶â–¶</a>
				<a @click.prevent="nextFamily()" style="cursor: pointer;">â–¶â–¶â–¶</a><br>
					{{list[id].mu}}->{{list[id].ke}}->{{list[id].shu}}->{{list[id].wu}}<br><br>
			</div>
			
			<span v-if="list[id].sn!=null">ã€å­¦åã€‘{{list[id].sn}}<br></span>
			<span v-if="list[id].en!=null">ã€è‹±æ–‡åã€‘{{list[id].en}}<br></span>
			<span @click="showcomment=!showcomment;if(!showcomment)addSubmitFlag=false;"
					style="cursor:pointer;font-weight:bold;color:blue;">ã€{{showcomment?"æŠ˜å ":"å±•å¼€"}}è¯„è®ºåŒºã€‘</span>

			<form v-if="showcomment" id="form" accept-charset="utf-8" action="https://formspree.io/f/mbjwjqev" method="POST">
				<label>æ˜µç§°:</label><input id="form_name" name="name" required="" maxlength="10" @change="addSubmit()">
				<input id="form_submit" type="submit" value="å‘é€"><br>
				<label>è¯„è®º:</label><textarea id="form_message" name="message" maxlength="256" required=""></textarea>
				<input type="hidden" name="item" :value=list[id].wu>
				<input type="hidden" name="page" value='bird'>
				<br><span style="color:blue;" id="my-form-status"></span>
			</form>
			<div v-if="showcomment" v-for="(item, i) in comments.submissions">
				<span v-if="item.page=='bird' && item.item==list[id].wu">
				<span style="font-weight:bold;color:brown;">{{item.name}}</span>: {{item.message}}
				<span style="color:gray;">{{showTime(item._date)}}</span><br></span>
			</div>
			<span v-if="list[id].pic!=null" style="cursor:pointer;" @click.prevent="window.location.href='../photo/index.html?wd='+list[id].wu"><br>ã€ä¿ºæ‹å—’ã€‘<br>
				<img class='myimg' v-if="id<1329" :src='"birds/"+list[id].ke.split("ç§‘")[0]+"."+list[id].wu.replace("[","").replace("]","")+".jpg"'>
				<img class='myimg' v-if="id>=1329" :src='"others/"+list[id].ke.split("ç§‘")[0]+"."+list[id].wu+".jpg"'>
			<br></span><br>
			<span v-if="list[id].des!=null">ã€ç‰¹å¾ã€‘{{list[id].des}}<br><br></span>
			<span v-if="list[id].de2!=null">ã€ç™¾ç§‘ã€‘{{list[id].de2}}<br><br></span>
			<span v-if="list[id].hm!=null">ã€è™¹è†œã€‘{{list[id].hm}}<br></span>
			<span v-if="list[id].hui!=null">ã€å–™ã€‘{{list[id].hui}}<br></span>
			<span v-if="list[id].zu!=null">ã€è„šã€‘{{list[id].zu}}<br></span>
			<span v-if="list[id].vo!=null">ã€å£°ã€‘{{list[id].vo}}<br><br></span>
			<span v-if="list[id].area!=null">ã€åˆ†å¸ƒã€‘{{list[id].area}}<br></span>			
			<span v-if="test && id<1329">ã€åˆ†å¸ƒå›¾ã€‘<br><img class='myimg' :src='"birdmap/b"+addZero(id+1)+".jpg"'><br><br></span>
			<span v-if="test && id<1329">ã€æ’å›¾ã€‘<br><img class='myimg' :src='"birdsall/b"+addZero(id+1)+".jpg"'><br><br></span>
			<br><br><div align="center"><a @click.prevent="id=-1;addSubmitFlag=false" style="cursor:pointer;">â–¶è¿”å›å†Œä¸»é¡µâ—€</a></div>
		</div>	
		<div v-if="id==-1" class="ret"><a :href="sessionStorage.getItem('cube')==true?'../../3dindex.html':'../../index.html'"> â–¶è¿”å›ä¸»é¡µâ—€</a></div>		
		<div class="footer">Copyright Â© 2017~19 é±¼å„¿. All Rights Reserved.</div><br><br>
	</div>
</body>
<script>
var cpageName=self.location.href.split('group/')[1].split('/')[0];
function loadScript(script){
	var _script = document.createElement('script');
	_script.type = "text/javascript";
	_script.src = script;
	document.head.appendChild(_script);
}
loadScript("../../main/js/head.js");
if(window.screen.width<1080) loadScript("../../main/js/navi2.js");
else loadScript("../../main/js/navi1.js");

var vm = new Vue({
	el: '#main',
	data:{
		list:birdjson.RECORDS,
		statename:["å–™|é»„","å–™|ç°","å–™|è¤","å–™|é»‘","å–™|çº¢","å–™|ç²‰","å–™|ç»¿","å–™|è§’è´¨",
			"è™¹è†œ|è¤","è™¹è†œ|æ©™","è™¹è†œ|çº¢","è™¹è†œ|é»„","è™¹è†œ|è“","è™¹è†œ|ç™½","è™¹è†œ|ç°","è™¹è†œ|æ·±","è™¹è†œ|æ£•",
			"è„š|é»‘","è„š|è¤","è„š|ç°","è„š|çº¢","è„š|ç²‰","è„š|é»„","è„š|è“","è„š|ç»¿","è„š|è‚‰",
			"åˆ†å¸ƒ|å–œé©¬æ‹‰é›…","åˆ†å¸ƒ|å¤©å±±","åˆ†å¸ƒ|é’è—é«˜åŸ","åˆ†å¸ƒ|äº‘å—","åˆ†å¸ƒ|å°æ¹¾","åˆ†å¸ƒ|ä¸­å›½ä¸­éƒ¨",
			"åˆ†å¸ƒ|ä¸­å›½å—éƒ¨","åˆ†å¸ƒ|ä¸­å›½åŒ—éƒ¨","åˆ†å¸ƒ|ä¸­å›½è¥¿éƒ¨","åˆ†å¸ƒ|ä¸­å›½ä¸œéƒ¨","åˆ†å¸ƒ|ä¸­å›½è¥¿å—","åˆ†å¸ƒ|ä¸­å›½è¥¿åŒ—",
			"åˆ†å¸ƒ|å°åº¦","åˆ†å¸ƒ|ä¸œå—äºš","åˆ†å¸ƒ|ä¸­ä¸œ","åˆ†å¸ƒ|ä¸­äºš","åˆ†å¸ƒ|å—æ¬§","åˆ†å¸ƒ|å¤ªå¹³æ´‹","åˆ†å¸ƒ|è²å¾‹å®¾","åˆ†å¸ƒ|è‹æ‹‰å¨è¥¿",
		],
		stategroup:{"å–™":"hui","è™¹è†œ":"hm","è„š":"zu","åˆ†å¸ƒ":"area",},		
		statevalue:[],
		statecolor:["#888","#000","#fff"],
		id:-1,
		showcomment:false,
		addSubmitFlag:false,
		test:false,
	},
	methods: {		
		reSet: function reSet(){
			for(let j=0;j<this.statename.length;j++) this.statevalue[j]=0;
			for(let j=0;j<this.list.length;j++) this.list[j].fliter= true;
			this.$forceUpdate();		
		},
		setType: function setType(i){
			this.statevalue[i]=(this.statevalue[i]+1)%3;
			for(let k=0;k<this.list.length;k++) this.getItem(k);
			this.$forceUpdate();
		},
		getItem: function getItem(i){
			//console.log("s");
			for(let j=0;j<this.statename.length;j++) {
				if(this.statevalue[j]==0) continue;				
				let get=0;
				let fenlei=this.statename[j].split("|")[0];
				let word=this.statename[j].split("|")[1];
				if(this.list[i][this.stategroup[fenlei]]==null) get=-1;
				else get=this.list[i][this.stategroup[fenlei]].indexOf(word);
				if(get!=-1 && this.statevalue[j]==1) continue;
				if(get==-1 && this.statevalue[j]==2) continue;
				this.list[i].fliter= false;	return;		
			}
			this.list[i].fliter= true; return;
		},
		getPre: function getPre(j){
			let i=j-1;
			for(;i>=0;i--) if(this.list[i].fliter) return i;
			return -1;
		},
		getNext: function getNext(j){
			let i=j+1;
			for(;i<this.list.length;i++) if(this.list[i].fliter) return i;
			return -1;
		},
		prePic: function prePic(){
			let i=this.getPre(this.id);
			while(i!=-1) if(this.list[i].pic!=null) break; else i=this.getPre(i);
			this.id=i;if(this.id==-1)this.addSubmitFlag=false;
		},
		nextPic: function nextPic(){
			let i=this.getNext(this.id);
			while(i!=-1) if(this.list[i].pic!=null) break; else i=this.getNext(i);
			this.id=i;if(this.id==-1)this.addSubmitFlag=false;
		},
		preFamily: function preFamily(){
			let i=this.getPre(this.id);
			while(i!=-1) if(this.list[i].ke!=this.list[this.id].ke) break; else i=this.getPre(i);
			this.id=i;if(this.id==-1)this.addSubmitFlag=false;
		},
		nextFamily: function nextFamily(){
			let i=this.getNext(this.id);
			while(i!=-1) if(this.list[i].ke!=this.list[this.id].ke) break; else i=this.getNext(i);
			this.id=i;if(this.id==-1)this.addSubmitFlag=false;
		},
		addZero: function addZero(i){
			if(i<10) return "000"+i;
			if(i<100) return "00"+i;
			if(i<1000) return "0"+i;
			return i;
		},
		addSubmit: function addSubmit(){
			if(this.addSubmitFlag) return;
			this.addSubmitFlag=true;
			document.getElementById("my-form-status").innerHTML="";
			var form = document.getElementById("form");
			
			async function handleSubmit(event) {
				event.preventDefault();
				var status = document.getElementById("my-form-status");
				status.innerHTML = "å‘é€ä¸­...";
				var data = new FormData(event.target);
				fetch(event.target.action, {
				method: form.method,
				body: data,
				headers: {
					'Accept': 'application/json'
				}
				}).then(response => {
				status.innerHTML = "å‘é€æˆåŠŸï¼ç´«æœˆç²¾é€‰åå³å¯çœ‹è§~";
				form.reset();
				}).catch(error => {
				status.innerHTML = "å‘é€å¤±è´¥äº†..."
				});
			}
			
			form.addEventListener("submit", handleSubmit)
			//alert(this.addSubmitFlag)
		},
		showTime: function showTime(s){
			return '('+s.split('.')[0].replace(/T/g, " ")+')';
		},
	},
	created: function created() {
		if(self.location.href.substring(0,4)!="http")this.test=true;
        this.reSet();
		let url=self.location.href;
		if(url.indexOf('=')>=0){
			let urlvalue=decodeURI(url.split('=')[1]);
			for(let i=0;i<this.list.length;i++) if(urlvalue==this.list[i].wu.replace(/[/g, "").replace(/]/g, "")) {this.id=i; break; }
		}
		var _this = this;
		document.onkeydown = function(e) {
            let key = window.event.keyCode;
			if (key == 36) {_this.id=-1;_this.addSubmitFlag=false;}
            if (key == 37) {
                if(_this.id!=-1) _this.prePic();//_this.id=_this.getPre(_this.id);
            }
			if (key == 39) {
                if(_this.id!=-1) _this.nextPic();//_this.id=_this.getNext(_this.id);
            }
        };
    },
	beforeUpdate: function beforeUpdate(){
		if(this.id>=0){
			if (document.body && document.body.scrollTop) 
				this.scrolltop=document.body.scrollTop;
			if (document.documentElement && document.documentElement.scrollTop) 
				this.scrolltop=document.documentElement.scrollTop;
		}
	},
	updated: function updated(){
		if(this.id<0) document.body.scrollTop=document.documentElement.scrollTop=this.scrolltop;
		else document.body.scrollTop=document.documentElement.scrollTop=0;
		if(this.id>=0)document.title=this.list[this.id].wu;
		else document.title="é³¥ä¹‹å†Œ";	
	},
})
</script>
</html>
